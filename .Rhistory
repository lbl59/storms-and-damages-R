hurricanes <- storms %>%select(!year:hour)
joined_hd <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
tidyverse_packages()
packageVersion('tidyr')
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>%filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>%select(!year:hour)
joined_hd <- inner_join(ts, damages)
joined_hd <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
library(tidyr)
library(dplyr)
library(lubridate)
# Question 1
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
# Question 2
# Question 2
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
# Question 3
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
joined_storms_damages <- inner_join(storms, damages)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>%filter(stringr::str_detect(status, "tropical storm"))
joined_hd <- inner_join(ts, damages)
ts <- ts %>%select(!year:hour)
joined_hd <- inner_join(ts, damages)
head(sd)
head(ts)
joined_sd <- inner_join(ts, damages)
head(joined_sd)
joined_sd <- inner_join(storms, damages)
joined_storms_damages <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
library(tidyr)
library(dplyr)
library(lubridate)
# Question 1
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
# Question 2
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
# Question 3
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
joined_storms_damages <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!year:hour)
ts <- ts %>% select(!year:hour)
joined_sd <- inner_join(storms, damages)
ts <- ts %>% select(!month:hour)
joined_sd <- inner_join(storms, damages)
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(ts, damages)
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
joined_sd <- inner_join(ts, damages)
joined_sd <- inner_join(storms, damages)
storms <- read.csv("storms.csv")
joined_sd <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
joined_sd <- inner_join(storms, damages)
joined_storms_damages <- inner_join(storms, damages)
# Question 1
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
# Question 2
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
# Question 5
joined_storms_damages <- inner_join(storms, damages)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
joined_sd <- inner_join(storms, damages)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(storms, damages)
joined_sd <- inner_join(ts, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
tidyverse_packages()
packageVersion('tidyr')
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(ts, damages)
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
joined_sd <- inner_join(ts, damages)
joined_sd <- inner_join(storms, damages)
View(joined_sd)
# Run this line
if (!require("pacman")) install.packages("pacman")
library(tidyr)
library(dplyr)
library(lubridate)
# Question 1
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
# Question 2
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
# Question 3
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
# Question 4
hurricanes <- storms %>% filter(stringr::str_detect(status, "hurricane"))
# Question 5
joined_storms_damages <- inner_join(storms, damages)
# Question 6
joined_storms_damages <- joined_storms_damages %>% mutate(
damage_per_mph = mean(damages)/wind
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse, dplyr
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(storms, damages)
ts <- storms %>% filter(stringr::str_detect(status, "hurricanes"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
tidyverse_packages()
packageVersion('tidyr')
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "hurricanes"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
library(tidyr)
library(dplyr)
library(lubridate)
# Question 1
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
# Question 2
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
# Question 3
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
# Question 4
hurricanes <- storms %>% filter(stringr::str_detect(status, "hurricane"))
# Question 5
joined_storms_damages <- inner_join(storms, damages)
joined_storms_damages <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
tidyverse_packages()
packageVersion('tidyr')
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "hurricanes"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_storms_damages <- inner_join(storms, damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "hurricanes"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_storms_damages <- inner_join(storms, damages)
joined_storms_damages <- inner_join(storms, damages)
hurricanes <- storms %>% filter(stringr::str_detect(status, "hurricane"))
joined_storms_damages <- inner_join(storms, damages)
# Question 3
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
joined_storms_damages <- inner_join(storms, damages)
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
# Question 2
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
# Question 3
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
# Question 4
hurricanes <- storms %>% filter(stringr::str_detect(status, "hurricane"))
# Question 5
joined_storms_damages <- inner_join(storms, damages)
ts <- storms %>% filter(stringr::str_detect(status, "hurricanes"))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storms"))
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storms"))
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storms") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storms"))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_storms_damages <- inner_join(ts, damages)
joined_storms_damages <- inner_join(storms, damages)
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
joined_storms_damages <- inner_join(storms, damages)
ts <- storms %>% filter(stringr::str_detect(status, "hurricanes"))
ts <- storms %>% filter(stringr::str_detect(status, "hurricane"))
joined_storms_damages <- inner_join(storms, damages)
# Question 2
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "hurricane"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(ts, damages)
joined_sd <- inner_join(storms, damages)
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(ts, damages)
head(joined_sd)
# Question 6
joined_storms_damages <- joined_storms_damages %>% mutate(
damage_per_mph = mean(damages)/wind
)
head(ts)
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(ts, damages)
joined_sd <- joined_sd %>%
arrange(damage_per_mph, decreasing = TRUE)
joined_storms_damages <- joined_storms_damages %>%
mutate(damage_per_mph = mean(damages)/wind) %>%
arrange(damage_per_mph, decreasing = TRUE)
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(ts, damages)
# calculate average cost of damage per windspeed
joined_sd <- joined_sd %>%
mutate(damage_per_mph = mean(damages)/wind) %>%
arrange(damage_per_mph, decreasing = TRUE)
head(joined_sd)
summarize(joined_sd)
summary_sd <- joined_sd %>% summarize(category)
summary_sd
summary_sd <- joined_sd %>% summarize(disp=mean(damage_per_mph), sd = sd(damage_per_mph))
summary_sd
# calculate average cost of damage per windspeed
joined_sd <- joined_sd %>%
mutate(damage_per_mph = mean(damages)/wind) %>%
arrange(damage_per_mph, decreasing = TRUE)
head(joined_sd)
joined_sd <- joined_sd %>%
mutate(damage_per_mph = mean(damages)/wind) %>%
arrange(damage_per_mph, decreasing = FALSE)
head(joined_sd)
# calculate average cost of damage per windspeed
joined_sd <- joined_sd %>%
mutate(damage_per_mph = mean(damages)/wind) %>%
arrange(desc(damage_per_mph))
head(joined_sd)
# summarize by mean and sd of cost per windspeed
summary_sd <- joined_sd %>% summarize(damage_per_mph=mean(damage_per_mph), sd = sd(damage_per_mph))
summary_sd
lm_damages_wind = lm(joined_storms_damages$damages ~ joined_storms_damages$wind)
joined_sd <- joined_sd %>% mutate(
estimate = lm_damages_wind$coefficients[1]
)
lm_damages_wind = lm(joined_sd$damages ~ joined_sd$wind)
joined_sd <- joined_sd %>% mutate(
estimate = lm_damages_wind$coefficients[1]
)
ggplot(joined_sd, aes(year, damage_per_mph))
ggplot(joined_sd, aes(year, damages))
# summarize by mean and sd of cost per windspeed
summary_sd <- joined_sd %>% summarize(
damage_per_mph=mean(damage_per_mph), sd = sd(damage_per_mph))
lm_damages_wind = lm(joined_sd$damages ~ joined_sd$wind)
joined_sd <- joined_sd %>% mutate(
estimate = lm_damages_wind$coefficients[1]
)
ggplot(joined_sd, aes(year, damages))
ggplot(joined_sd, aes(year, damages)) +
geom_point()
ggplot(joined_sd, aes(year, damages)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, wind)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, damage_per_mph)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, damage_per_mph)) +
geom_point() +
ggplotRegression(lm(joined_sd$damages ~ joined_sd$year))
ggplot(joined_sd, aes(year, damage_per_mph)) +
geom_point() +
stat_smooth(lm(joined_sd$damages ~ joined_sd$year))
ggplot(joined_sd, aes(year, damage_per_mph)) +
geom_point() +
stat_smooth(lm(joined_sd$damage_per_mph ~ joined_sd$year))
ggplot(joined_sd, aes(year, damage_per_mph)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, damages)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
lm_damages_wind = lm(joined_sd$damage_per_mph ~ joined_sd$wind)
joined_sd <- joined_sd %>% mutate(
estimate = lm_damages_wind$coefficients[1]
)
ggplot(joined_sd, aes(year, damage_per_mph)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, damages)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(damages), max(damages))+
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
stat_smooth(method = "lm", col = "red")
# summarize by mean and sd of cost per windspeed
summary_sd <- joined_sd %>% summarize(
damage_per_mph=mean(damage_per_mph), sd = sd(damage_per_mph))
lm_damages_wind = lm(joined_sd$damages ~ joined_sd$wind)
joined_sd <- joined_sd %>% mutate(
estimate = lm_damages_wind$coefficients[1]
)
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
stat_smooth(method = "lm", col = "red")
min(joined_sd$damages)
# Run this line
if (!require("pacman")) install.packages("pacman")
# Then run lines 5-7
pacman::p_load(
tidyverse
)
# Load dataset
storms <- read.csv("storms.csv")
damages <- read.csv("damages.csv")
damages <- damages %>% mutate(status = "tropical storm") %>%
pivot_longer(-status, names_to="name", values_to="damages")
storms <- storms %>% mutate(date=as_datetime(
paste0(year, "-", month, "-", day, " ", hour, ":00:00")))
ts <- storms %>% filter(stringr::str_detect(status, "tropical storm"))
ts <- ts %>% select(!ts_diameter:hu_diameter)
joined_sd <- inner_join(ts, damages)
# calculate average cost of damage per windspeed
joined_sd <- joined_sd %>%
mutate(damage_per_mph = mean(damages)/wind) %>%
arrange(desc(damage_per_mph))
# summarize by mean and sd of cost per windspeed
summary_sd <- joined_sd %>% summarize(
damage_per_mph=mean(damage_per_mph), sd = sd(damage_per_mph))
lm_damages_wind = lm(joined_sd$damages ~ joined_sd$wind)
joined_sd <- joined_sd %>% mutate(
estimate = lm_damages_wind$coefficients[1]
)
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
stat_smooth(method = "lm", col = "red")
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
geom_smooth(joined_sd$damages ~ joined_sd$year)
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
geom_smooth()
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
geom_smooth(method = lm, se = FALSE)
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
geom_smooth(method = lm)
ggplot(joined_sd, aes(year, damage_per_mph)) +
geom_point() + ylim(min(joined_sd$damage_per_mph), max(joined_sd$damage_per_mph)) +
geom_smooth(method = lm)
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
geom_smooth(method = lm)
ggplot(joined_sd, aes(year, damages)) +
geom_point() + ylim(min(joined_sd$damages), max(joined_sd$damages)) +
geom_smooth(method = lm) + ggtitle("Damages ($) with respect to time")
